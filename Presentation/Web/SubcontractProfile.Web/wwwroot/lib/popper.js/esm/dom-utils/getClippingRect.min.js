import{viewport}from"../enums.js";import getViewportRect from"./getViewportRect.js";import getDocumentRect from"./getDocumentRect.js";import listScrollParents from"./listScrollParents.js";import getOffsetParent from"./getOffsetParent.js";import getDocumentElement from"./getDocumentElement.js";import getComputedStyle from"./getComputedStyle.js";import{isElement,isHTMLElement}from"./instanceOf.js";import getBoundingClientRect from"./getBoundingClientRect.js";import contains from"./contains.js";import rectToClientRect from"../utils/rectToClientRect.js";function getInnerBoundingClientRect(t){var e=getBoundingClientRect(t);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}function getClientRectFromMixedType(t,e){return e===viewport?rectToClientRect(getViewportRect(t)):isHTMLElement(e)?getInnerBoundingClientRect(e):rectToClientRect(getDocumentRect(getDocumentElement(t)))}function getClippingParents(t){var e=listScrollParents(t),n=["absolute","fixed"].indexOf(getComputedStyle(t).position)>=0&&isHTMLElement(t)?getOffsetParent(t):t;return isElement(n)?e.filter(function(t){return isElement(t)&&contains(t,n)}):[]}export default function getClippingRect(t,e,n){var i="clippingParents"===e?getClippingParents(t):[].concat(e),o=[].concat(i,[n]),r=o[0],l=o.reduce(function(e,n){var i=getClientRectFromMixedType(t,n);return e.top=Math.max(i.top,e.top),e.right=Math.min(i.right,e.right),e.bottom=Math.min(i.bottom,e.bottom),e.left=Math.max(i.left,e.left),e},getClientRectFromMixedType(t,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l};